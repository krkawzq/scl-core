"""
Auto-generated Python bindings for enrichment

Source: scl/binding/c_api/enrichment.h
Generated by: generate_bindings.py

DO NOT EDIT - This file is automatically generated.
"""

from __future__ import annotations

from ctypes import (
    CFUNCTYPE,
    POINTER,
    Structure,
    c_bool,
    c_char,
    c_char_p,
    c_double,
    c_float,
    c_int,
    c_int8,
    c_int16,
    c_int32,
    c_int64,
    c_long,
    c_longlong,
    c_short,
    c_size_t,
    c_ssize_t,
    c_ubyte,
    c_uint,
    c_uint8,
    c_uint16,
    c_uint32,
    c_uint64,
    c_ulong,
    c_ulonglong,
    c_ushort,
    c_void_p,
    c_wchar_p,
)
from typing import Any, Optional

from .._loader import get_library

# Load the native library
_lib = get_library()


# ===========================================================================
# Functions
# ===========================================================================

# C: int scl_enrichment_hypergeometric_test(long k, long n, long K, long N, scl_real_t * p_value_out)
_lib.scl_enrichment_hypergeometric_test.argtypes = [c_long, c_long, c_long, c_long, POINTER(c_double)]
_lib.scl_enrichment_hypergeometric_test.restype = c_int

def scl_enrichment_hypergeometric_test(k, n, K, N, p_value_out):
    """
    Args:
        k: long
        n: long
        K: long
        N: long
        p_value_out: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_hypergeometric_test(k, n, K, N, p_value_out)


# C: int scl_enrichment_fisher_exact_test(long a, long b, long c, long d, scl_real_t * p_value_out)
_lib.scl_enrichment_fisher_exact_test.argtypes = [c_long, c_long, c_long, c_long, POINTER(c_double)]
_lib.scl_enrichment_fisher_exact_test.restype = c_int

def scl_enrichment_fisher_exact_test(a, b, c, d, p_value_out):
    """
    Args:
        a: long
        b: long
        c: long
        d: long
        p_value_out: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_fisher_exact_test(a, b, c, d, p_value_out)


# C: int scl_enrichment_odds_ratio(long a, long b, long c, long d, scl_real_t * odds_ratio_out)
_lib.scl_enrichment_odds_ratio.argtypes = [c_long, c_long, c_long, c_long, POINTER(c_double)]
_lib.scl_enrichment_odds_ratio.restype = c_int

def scl_enrichment_odds_ratio(a, b, c, d, odds_ratio_out):
    """
    Args:
        a: long
        b: long
        c: long
        d: long
        odds_ratio_out: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_odds_ratio(a, b, c, d, odds_ratio_out)


# C: int scl_enrichment_gsea(const scl_index_t * ranked_genes, const scl_real_t * ranking_scores, const int * in_gene_set, long n_genes, scl_real_t * enrichment_score_out, scl_real_t * p_value_out, long n_permutations, unsigned long seed)
_lib.scl_enrichment_gsea.argtypes = [POINTER(c_int64), POINTER(c_double), POINTER(c_int), c_long, POINTER(c_double), POINTER(c_double), c_long, c_ulong]
_lib.scl_enrichment_gsea.restype = c_int

def scl_enrichment_gsea(ranked_genes, ranking_scores, in_gene_set, n_genes, enrichment_score_out, p_value_out, n_permutations, seed):
    """
    Args:
        ranked_genes: const scl_index_t *
        ranking_scores: const scl_real_t *
        in_gene_set: const int *
        n_genes: long
        enrichment_score_out: scl_real_t *
        p_value_out: scl_real_t *
        n_permutations: long
        seed: unsigned long
    
    Returns:
        int
    """
    return _lib.scl_enrichment_gsea(ranked_genes, ranking_scores, in_gene_set, n_genes, enrichment_score_out, p_value_out, n_permutations, seed)


# C: int scl_enrichment_gsea_running_sum(const scl_index_t * ranked_genes, const int * in_gene_set, long n_genes, scl_real_t * running_sum)
_lib.scl_enrichment_gsea_running_sum.argtypes = [POINTER(c_int64), POINTER(c_int), c_long, POINTER(c_double)]
_lib.scl_enrichment_gsea_running_sum.restype = c_int

def scl_enrichment_gsea_running_sum(ranked_genes, in_gene_set, n_genes, running_sum):
    """
    Args:
        ranked_genes: const scl_index_t *
        in_gene_set: const int *
        n_genes: long
        running_sum: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_gsea_running_sum(ranked_genes, in_gene_set, n_genes, running_sum)


# C: int scl_enrichment_leading_edge_genes(const scl_index_t * ranked_genes, const int * in_gene_set, long n_genes, double enrichment_score, scl_index_t * leading_genes, int max_leading, scl_index_t * n_leading_out)
_lib.scl_enrichment_leading_edge_genes.argtypes = [POINTER(c_int64), POINTER(c_int), c_long, c_double, POINTER(c_int64), c_int, POINTER(c_int64)]
_lib.scl_enrichment_leading_edge_genes.restype = c_int

def scl_enrichment_leading_edge_genes(ranked_genes, in_gene_set, n_genes, enrichment_score, leading_genes, max_leading, n_leading_out):
    """
    Args:
        ranked_genes: const scl_index_t *
        in_gene_set: const int *
        n_genes: long
        enrichment_score: double
        leading_genes: scl_index_t *
        max_leading: int
        n_leading_out: scl_index_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_leading_edge_genes(ranked_genes, in_gene_set, n_genes, enrichment_score, leading_genes, max_leading, n_leading_out)


# C: int scl_enrichment_ora_single_set(const scl_index_t * de_genes, int n_de_genes, const scl_index_t * pathway_genes, int n_pathway_genes, long n_total_genes, scl_real_t * p_value_out, scl_real_t * odds_ratio_out, scl_real_t * fold_enrichment_out)
_lib.scl_enrichment_ora_single_set.argtypes = [POINTER(c_int64), c_int, POINTER(c_int64), c_int, c_long, POINTER(c_double), POINTER(c_double), POINTER(c_double)]
_lib.scl_enrichment_ora_single_set.restype = c_int

def scl_enrichment_ora_single_set(de_genes, n_de_genes, pathway_genes, n_pathway_genes, n_total_genes, p_value_out, odds_ratio_out, fold_enrichment_out):
    """
    Args:
        de_genes: const scl_index_t *
        n_de_genes: int
        pathway_genes: const scl_index_t *
        n_pathway_genes: int
        n_total_genes: long
        p_value_out: scl_real_t *
        odds_ratio_out: scl_real_t *
        fold_enrichment_out: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_ora_single_set(de_genes, n_de_genes, pathway_genes, n_pathway_genes, n_total_genes, p_value_out, odds_ratio_out, fold_enrichment_out)


# C: int scl_enrichment_ora_batch(const scl_index_t * de_genes, int n_de_genes, const scl_index_t *const * pathway_genes, const scl_index_t * pathway_sizes, long n_pathways, long n_total_genes, scl_real_t * p_values, scl_real_t * odds_ratios, scl_real_t * fold_enrichments)
_lib.scl_enrichment_ora_batch.argtypes = [POINTER(c_int64), c_int, POINTER(POINTER(c_int64)), POINTER(c_int64), c_long, c_long, POINTER(c_double), POINTER(c_double), POINTER(c_double)]
_lib.scl_enrichment_ora_batch.restype = c_int

def scl_enrichment_ora_batch(de_genes, n_de_genes, pathway_genes, pathway_sizes, n_pathways, n_total_genes, p_values, odds_ratios, fold_enrichments):
    """
    Args:
        de_genes: const scl_index_t *
        n_de_genes: int
        pathway_genes: const scl_index_t *const *
        pathway_sizes: const scl_index_t *
        n_pathways: long
        n_total_genes: long
        p_values: scl_real_t *
        odds_ratios: scl_real_t *
        fold_enrichments: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_ora_batch(de_genes, n_de_genes, pathway_genes, pathway_sizes, n_pathways, n_total_genes, p_values, odds_ratios, fold_enrichments)


# C: int scl_enrichment_benjamini_hochberg(const scl_real_t * p_values, int n, scl_real_t * q_values)
_lib.scl_enrichment_benjamini_hochberg.argtypes = [POINTER(c_double), c_int, POINTER(c_double)]
_lib.scl_enrichment_benjamini_hochberg.restype = c_int

def scl_enrichment_benjamini_hochberg(p_values, n, q_values):
    """
    Args:
        p_values: const scl_real_t *
        n: int
        q_values: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_benjamini_hochberg(p_values, n, q_values)


# C: int scl_enrichment_bonferroni(const scl_real_t * p_values, int n, scl_real_t * adjusted_p)
_lib.scl_enrichment_bonferroni.argtypes = [POINTER(c_double), c_int, POINTER(c_double)]
_lib.scl_enrichment_bonferroni.restype = c_int

def scl_enrichment_bonferroni(p_values, n, adjusted_p):
    """
    Args:
        p_values: const scl_real_t *
        n: int
        adjusted_p: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_bonferroni(p_values, n, adjusted_p)


# C: int scl_enrichment_pathway_activity(struct scl_sparse_matrix * X, const scl_index_t * pathway_genes, int n_pathway_genes, long n_cells, long n_genes, scl_real_t * activity_scores)
_lib.scl_enrichment_pathway_activity.argtypes = [POINTER(c_void_p), POINTER(c_int64), c_int, c_long, c_long, POINTER(c_double)]
_lib.scl_enrichment_pathway_activity.restype = c_int

def scl_enrichment_pathway_activity(X, pathway_genes, n_pathway_genes, n_cells, n_genes, activity_scores):
    """
    Args:
        X: struct scl_sparse_matrix *
        pathway_genes: const scl_index_t *
        n_pathway_genes: int
        n_cells: long
        n_genes: long
        activity_scores: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_pathway_activity(X, pathway_genes, n_pathway_genes, n_cells, n_genes, activity_scores)


# C: int scl_enrichment_gsva_score(struct scl_sparse_matrix * X, const scl_index_t * pathway_genes, int n_pathway_genes, long n_cells, long n_genes, scl_real_t * gsva_scores)
_lib.scl_enrichment_gsva_score.argtypes = [POINTER(c_void_p), POINTER(c_int64), c_int, c_long, c_long, POINTER(c_double)]
_lib.scl_enrichment_gsva_score.restype = c_int

def scl_enrichment_gsva_score(X, pathway_genes, n_pathway_genes, n_cells, n_genes, gsva_scores):
    """
    Args:
        X: struct scl_sparse_matrix *
        pathway_genes: const scl_index_t *
        n_pathway_genes: int
        n_cells: long
        n_genes: long
        gsva_scores: scl_real_t *
    
    Returns:
        int
    """
    return _lib.scl_enrichment_gsva_score(X, pathway_genes, n_pathway_genes, n_cells, n_genes, gsva_scores)


# C: int scl_enrichment_ssgsea(struct scl_sparse_matrix * X, const scl_index_t * pathway_genes, int n_pathway_genes, long n_cells, long n_genes, scl_real_t * enrichment_scores, double weight_exponent)
_lib.scl_enrichment_ssgsea.argtypes = [POINTER(c_void_p), POINTER(c_int64), c_int, c_long, c_long, POINTER(c_double), c_double]
_lib.scl_enrichment_ssgsea.restype = c_int

def scl_enrichment_ssgsea(X, pathway_genes, n_pathway_genes, n_cells, n_genes, enrichment_scores, weight_exponent):
    """
    Args:
        X: struct scl_sparse_matrix *
        pathway_genes: const scl_index_t *
        n_pathway_genes: int
        n_cells: long
        n_genes: long
        enrichment_scores: scl_real_t *
        weight_exponent: double
    
    Returns:
        int
    """
    return _lib.scl_enrichment_ssgsea(X, pathway_genes, n_pathway_genes, n_cells, n_genes, enrichment_scores, weight_exponent)


# ===========================================================================
# Exports
# ===========================================================================

__all__ = [
    "scl_enrichment_benjamini_hochberg",
    "scl_enrichment_bonferroni",
    "scl_enrichment_fisher_exact_test",
    "scl_enrichment_gsea",
    "scl_enrichment_gsea_running_sum",
    "scl_enrichment_gsva_score",
    "scl_enrichment_hypergeometric_test",
    "scl_enrichment_leading_edge_genes",
    "scl_enrichment_odds_ratio",
    "scl_enrichment_ora_batch",
    "scl_enrichment_ora_single_set",
    "scl_enrichment_pathway_activity",
    "scl_enrichment_ssgsea",
]