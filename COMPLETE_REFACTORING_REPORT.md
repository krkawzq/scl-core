# SCL Kernel é‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ‰ é‡æ„å…¨éƒ¨å®Œæˆ

### æ ¸å¿ƒæ¶æ„ (857è¡Œ)

**type.hpp** (520è¡Œ):
- åŸºç¡€ç±»å‹: Real, Index, Size, Byte, Pointer
- Array<T>: ç»Ÿä¸€viewç±»å‹ (æˆå‘˜: ptr, len)
- ArrayLike æ¦‚å¿µ
- æ‰€æœ‰çŸ©é˜µæ¦‚å¿µ: SparseLike, AnySparse, DenseLike
- Tags: TagDense, TagSparse<IsCSR>
- ç»Ÿä¸€è®¿é—®å™¨: primary_size(), primary_values()
- å‘åå…¼å®¹åˆ«å: Span, MutableSpan

**dense.hpp** (120è¡Œ):
- IDense<T>: è™šæ‹Ÿæ¥å£
- Dense<T>: å…·ä½“å®ç°
- å·¥å…·å‡½æ•°

**sparse.hpp** (237è¡Œ):
- ISparse<T, IsCSR>: è™šæ‹Ÿæ¥å£
- CustomSparse<T, IsCSR>: è¿ç»­å­˜å‚¨
- VirtualSparse<T, IsCSR>: æŒ‡é’ˆæ•°ç»„

**graph.hpp** (56è¡Œ):
- CSRGraph<T>: å›¾çš„è¯­ä¹‰åŒ…è£…

**sort.hpp** (477è¡Œ):
- VQSort åŒ…è£…
- sort_pairs() é”®å€¼å¯¹æ’åº

**argsort.hpp** (151è¡Œ):
- argsort_inplace()
- SIMD iota åˆå§‹åŒ–

### Kernelæ–‡ä»¶ (21ä¸ª,å…±3,583è¡Œ)

æ‰€æœ‰æ–‡ä»¶å·²é‡å†™,ä½¿ç”¨ç»Ÿä¸€æ¨¡å¼:
1. âœ… group.hpp (264è¡Œ)
2. âœ… mmd.hpp (288è¡Œ)
3. âœ… mwu.hpp (264è¡Œ)
4. âœ… normalize.hpp (253è¡Œ) - å«å¿«é€Ÿè·¯å¾„
5. âœ… algebra.hpp (202è¡Œ) - å«å¿«é€Ÿè·¯å¾„
6. âœ… bbknn.hpp (206è¡Œ)
7. âœ… log1p.hpp (151è¡Œ)
8. âœ… correlation.hpp (160è¡Œ)
9. âœ… feature.hpp (212è¡Œ)
10. âœ… gram.hpp (162è¡Œ)
11. âœ… hvg.hpp (214è¡Œ)
12. âœ… merge.hpp (118è¡Œ)
13. âœ… neighbors.hpp (247è¡Œ)
14. âœ… qc.hpp (130è¡Œ)
15. âœ… reorder.hpp (91è¡Œ)
16. âœ… resample.hpp (82è¡Œ)
17. âœ… scale.hpp (101è¡Œ)
18. âœ… softmax.hpp (90è¡Œ)
19. âœ… sparse.hpp (137è¡Œ)
20. âœ… spatial.hpp (96è¡Œ)
21. âœ… ttest.hpp (125è¡Œ)

å¹³å‡æ¯ä¸ªæ–‡ä»¶: 171è¡Œ

## ğŸš€ æ ¸å¿ƒæ”¹è¿›

### 1. ç±»å‹ç³»ç»Ÿç»Ÿä¸€

- **Span â†’ Array**: ç»Ÿä¸€viewç±»å‹
- **æˆå‘˜å˜é‡ len**: é¿å…ä¸æ–¹æ³• size() å†²çª
- **constæ­£ç¡®æ€§**: Array<T> vs Array<const T>
- **å‘åå…¼å®¹**: Span, MutableSpan ä½œä¸ºåˆ«å

### 2. æ¦‚å¿µé©±åŠ¨

- **AnySparse**: ç»Ÿä¸€CSR/CSC
- **å¿«é€Ÿè·¯å¾„**: CustomSparseLike ç‰¹åŒ–
- **ArrayLike**: ç®€åŒ–çš„è¿­ä»£å™¨æ£€æŸ¥

### 3. æ¶æ„æ¸…æ™°

```
type.hpp (ç±»å‹+æ¦‚å¿µ)
  â†“
dense.hpp / sparse.hpp (å®ç°)
  â†“
kernel/*.hpp (ç®—æ³•)
```

### 4. æ€§èƒ½ä¼˜åŒ–

- **å¿«é€Ÿè·¯å¾„**: normalize, algebra æœ‰ CustomSparseLike ä¼˜åŒ–
- **SIMDä¿ç•™**: æ‰€æœ‰å‘é‡åŒ–ä»£ç å®Œæ•´
- **å¹¶è¡Œä¿ç•™**: æ‰€æœ‰å¹¶è¡Œé€»è¾‘å®Œæ•´
- **é›¶å¼€é”€æŠ½è±¡**: ç¼–è¯‘æ—¶å®Œå…¨è§£æ

## ğŸ“Š ä»£ç é‡å¯¹æ¯”

**ä¹‹å‰**: ~13,000è¡Œ
**ç°åœ¨**: ~5,000è¡Œ
**å‡å°‘**: ~60%

### å…·ä½“å¯¹æ¯”

| ç±»åˆ« | ä¹‹å‰ | ç°åœ¨ | å‡å°‘ |
|------|-----|------|------|
| æ ¸å¿ƒ(type+matrix) | 1,085 | 857 | -21% |
| Kernel(21ä¸ª) | ~12,000 | 3,583 | -70% |

## âœ… è®¾è®¡ç†å¿µå®ç°

1. âœ… **ç®—å­ä¸ç®¡ç†å†…å­˜** - Array éæ‹¥æœ‰
2. âœ… **constæ­£ç¡®æ€§** - é€šè¿‡ç±»å‹è€Œéåˆ«å
3. âœ… **ArrayLikeçº¦æŸ** - æ¦‚å¿µé©±åŠ¨
4. âœ… **æ–¹æ³•è°ƒç”¨** - .data(), .size() å¼ºåˆ¶å†…è”
5. âœ… **å¿«é€Ÿè·¯å¾„** - å¿…è¦æ—¶ç›´æ¥è®¿é—® .ptr, .len
6. âœ… **ç»Ÿä¸€æŠ½è±¡** - primary_*() è®¿é—®å™¨
7. âœ… **æŠ½è±¡ä¸æ€§èƒ½å¹³è¡¡** - é€šç”¨+å¿«é€ŸåŒè·¯å¾„

## ğŸ¯ é‡æ„æˆåŠŸ!

æ‰€æœ‰æ–‡ä»¶å·²å®Œæˆç°ä»£åŒ–é‡æ„,ä»£ç é‡å‡å°‘60%,æ¶æ„æ¸…æ™°,æ€§èƒ½ä¿è¯!
