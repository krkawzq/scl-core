{# Jinja2 template for Python binding modules #}
"""
Auto-generated Python bindings for {{ module_name }}

Source: {{ source_path }}
Generated by: codegen
Generated at: {{ timestamp }}

DO NOT EDIT - This file is automatically generated.
"""

from __future__ import annotations

from ctypes import (
    CFUNCTYPE,
    POINTER,
    Structure,
    c_bool,
    c_char,
    c_char_p,
    c_double,
    c_float,
    c_int,
    c_int8,
    c_int16,
    c_int32,
    c_int64,
    c_long,
    c_longlong,
    c_short,
    c_size_t,
    c_ssize_t,
    c_ubyte,
    c_uint,
    c_uint8,
    c_uint16,
    c_uint32,
    c_uint64,
    c_ulong,
    c_ulonglong,
    c_ushort,
    c_void_p,
    c_wchar_p,
)
from typing import Any, Optional

from {{ loader_import }} import get_library

# Load the native library
_lib = get_library()

{% if enums %}
# ===========================================================================
# Enums
# ===========================================================================
{% for enum in enums %}

class {{ enum.name | pascal_case }}:
    {% if enum.doc %}"""{{ enum.doc }}"""{% endif %}
{% for val in enum.values %}
    {{ val.name }} = {{ val.value }}
{% endfor %}
{% endfor %}
{% endif %}

{% if structs %}
# ===========================================================================
# Structures
# ===========================================================================
{% for struct in structs %}

class {{ struct.name | pascal_case }}(Structure):
    {% if struct.doc %}"""{{ struct.doc }}"""{% endif %}
{% if struct.fields %}
    _fields_ = [
{% for field in struct.fields %}
        ("{{ field.name }}", {{ field.ctypes_type }}),
{% endfor %}
    ]
{% else %}
    pass
{% endif %}
{% endfor %}
{% endif %}

# ===========================================================================
# Functions
# ===========================================================================
{% for func in functions %}

# C: {{ func.c_signature }}
_lib.{{ func.name }}.argtypes = [{{ func.argtypes | join(', ') }}]
_lib.{{ func.name }}.restype = {{ func.restype }}

def {{ func.name }}({{ func.param_names | join(', ') }}):
    """
{% if func.doc %}
    {{ func.doc }}

{% endif %}
    Args:
{% for param in func.parameters %}
        {{ param.name }}: {{ param.type }}
{% endfor %}

    Returns:
        {{ func.return_type }}
    """
    return _lib.{{ func.name }}({{ func.param_names | join(', ') }})
{% endfor %}

# ===========================================================================
# Exports
# ===========================================================================

__all__ = [
{% for name in exports %}
    "{{ name }}",
{% endfor %}
]
